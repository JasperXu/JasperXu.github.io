<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="UTF-8" />
    <title>JasperXu's 笔记本</title>
    <meta name="keywords" content="其他文章,树莓派,OMV" />
    <meta name="description" content="树莓派 4b(一)安装 OMV" />
    <meta name="tags" content="树莓派, OMV" />
    <meta name="categories" content="其他文章" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="baidu_union_verify" content="e433cc4f7710de79eb4383e0ab66872f" />
    <meta name="description" content="JasperXu's 笔记本" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
    <link rel="stylesheet" href="/lib/bootstrap-4.6.0/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free-5.15.3/css/all.min.css" />
    <link rel="stylesheet" href="/lib/css/simple.css" />
    <link rel="stylesheet" href="/lib/prismjs-1.23.0/prism.css" />
    <link rel="stylesheet" href="/lib/katex-0.13.2/dist/katex.min.css" crossorigin="anonymous" />
    <link rel="stylesheet" href="/lib/gitalk-1.7.2/dist/gitalk.css" />

    <!-- 百度统计 -->
    <script>
      var _hmt = _hmt || [];
      (function () {
        if (document.domain != "localhost") {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?ba2da28ca00435302909ee9426bcadab";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        }
      })();
    </script>
  </head>
  <body>
    <header class="fixed-top">
      <a class="navbar-brand" href="#">JasperXu's 笔记本</a>
      <button
        class="navbar-toggler"
        style="margin-right: 5.5rem"
        type="button"
        data-toggle="collapse"
        data-target="#top-nav"
        aria-controls="top-nav"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <nav class="top-nav hide-nav" id="top-nav">
        <!-- <form class="form-inline ml-auto">
          <div class="input-group">
            <input class="form-control" type="search" placeholder="Search" aria-label="Search" />
            <div class="input-group-append">
              <button class="btn btn-outline-light" type="submit"><i class="fas fa-search"></i></button>
            </div>
          </div>
        </form> -->
        <!-- _navbar.md -->

<ul>
<li><a href="/">首页</a></li>
<li><a href="/Note/Other/">其他文章</a><ul>
<li><a href="/Note/Other/矩阵运算速查.html">矩阵运算速查</a></li>
<li><a href="/Note/Other/树莓派4b(一)安装OMV.html">树莓派 4b(一)安装 OMV</a></li>
<li><a href="/Note/Other/npm上传自己的包.html">npm 上传自己的包</a></li>
<li><a href="/Note/Other/Excel第一次打开空白的问题.html">Excel 第一次打开空白的问题</a></li>
</ul>
</li>
</ul>

      </nav>
    </header>
    <main class="container-fluid">
      <div class="row flex-xl-nowrap">
        <section class="cover d-flex">
          <div>
            
          </div>
        </section>
        <aside class="aside col-12 col-md-3 col-xl-2 d-none d-md-block">
          <nav class="side-nav hide-nav" id="side-nav">
            <!-- _sidebar.md -->

<ul>
<li><a href="/">首页</a></li>
<li><a href="/Note/Other/">其他文章</a><ul>
<li><a href="/Note/Other/矩阵运算速查.html">矩阵运算速查</a></li>
<li><a href="/Note/Other/树莓派4b(一)安装OMV.html">树莓派 4b(一)安装 OMV</a></li>
<li><a href="/Note/Other/npm上传自己的包.html">npm 上传自己的包</a></li>
<li><a href="/Note/Other/Excel第一次打开空白的问题.html">Excel 第一次打开空白的问题</a></li>
</ul>
</li>
</ul>

          </nav>
        </aside>
        <section class="content col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 col-sm-12">
          <article class="article">
            <article class='markdown-section' id='main'><div style="font-size: 0.75rem;"> &nbsp;<div class="float-left">发布时间：<i class='far fa-calendar-alt'></i> 2021-01-11 17:00 </div><div class="float-right">修订时间：<i class='far fa-calendar-alt'></i> 2021-04-26 02:12 </div></div><h1 id='树莓派-4b一安装-omv' ><a href='#anchor_树莓派-4b一安装-omv' id='anchor_树莓派-4b一安装-omv' class='anchor'>树莓派 4b(一)安装 OMV</a></h1>
<h2 id='查看设备版本' ><a href='#anchor_查看设备版本' id='anchor_查看设备版本' class='anchor'>查看设备版本</a></h2>
<pre><code class="language-bash"># 查看设备型号
$ cat /proc/device-tree/model
Raspberry Pi 4 Model B Rev 1.2

# 查看系统信息
$ lsb_release -a
No LSB modules are available.
Distributor ID: Raspbian
Description:    Raspbian GNU/Linux 10 (buster)
Release:        10
Codename:       buster

# 查看cpu & gpu温度
$ vcgencmd measure_temp
temp=28.2'C

# 查看cpu当前频率
$ sudo cpufreq-info -w -m

# 查看cpu信息
$ lscpu
显示很多就不列出来了

# 查看内存
$ free -h
              total        used        free      shared  buff/cache   available
Mem:          3.7Gi       265Mi       1.9Gi        75Mi       1.6Gi       3.2Gi
Swap:          99Mi          0B        99Mi

# 查看硬盘
$ lsblk
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
mmcblk0     179:0    0  29.3G  0 disk
├─mmcblk0p1 179:1    0   256M  0 part /boot
└─mmcblk0p2 179:2    0    29G  0 part /

# 查看网络
$ ifconfig

# 查看usb设备
lsusb
# 查看其它硬件
lsmod
</code></pre>
<p>设备信息：Raspberry Pi 4b 4G v1.2</p>
<h2 id='安装系统' ><a href='#anchor_安装系统' id='anchor_安装系统' class='anchor'>安装系统</a></h2>
<p><a href="https://www.raspberrypi.org/software/operating-systems/#raspberry-pi-os-32-bit" target="_blank" >下载地址</a> 推荐下载 <strong>Raspberry Pi OS with desktop</strong> 下面是安装后的默认值。</p>
<pre><code class="language-bash">设备名：raspberrypi
账户：pi
密码：raspberry
</code></pre>
<p>然后使用 Rufus 软件写入到 TF 卡中。</p>
<p>TF 卡根目录创建文件名为 <code>ssh</code> 的空文件，不要有后缀。可以自动打开 ssh。</p>
<p>然后装上 tf 卡，连上网线，显示器，键盘，鼠标，通电开机。</p>
<h2 id='设置系统' ><a href='#anchor_设置系统' id='anchor_设置系统' class='anchor'>设置系统</a></h2>
<p>一开始选中文就完事了，然后一路 next，完毕后重启 <code>sudo shutdown -r now</code> 。</p>
<p>然后系统就是中文了。</p>
<h3 id='设置-vnc-和-ssh' ><a href='#anchor_设置-vnc-和-ssh' id='anchor_设置-vnc-和-ssh' class='anchor'>设置 VNC 和 SSH</a></h3>
<p>左上角 &gt; 首选项 &gt; Raspberry Pi Configuration &gt; Interfaces</p>
<p>将 SSH 和 VNC 选到 Enable。</p>
<p>然后重启 <code>sudo shutdown -r now</code> 。</p>
<h4 id='cannot-currently-show-the-desktop-问题修复' ><a href='#anchor_cannot-currently-show-the-desktop-问题修复' id='anchor_cannot-currently-show-the-desktop-问题修复' class='anchor'>Cannot currently show the desktop 问题修复</a></h4>
<p>VNC 显示 Cannot currently show the desktop 则进行如下设置</p>
<pre><code>sudo raspi-config
选择 【2 Display Options】
选择 【D1 Resolution】
选择 【只要不选第一个就行，我这里选的1440x900 60Hz 16:10】
</code></pre>
<h3 id='设置网络' ><a href='#anchor_设置网络' id='anchor_设置网络' class='anchor'>设置网络</a></h3>
<p>右上角设置网络，<strong>隐藏网络是无法连接的</strong> 。反正我用的有线网络无所谓。</p>
<p>打开终端输入 <code>ifconfig</code> 查看下你的 IP 地址，我这里是 <code>192.168.199.2</code> 后面都会用这个地址。</p>
<h3 id='设置清华的源' ><a href='#anchor_设置清华的源' id='anchor_设置清华的源' class='anchor'>设置清华的源</a></h3>
<pre><code class="language-bash"># 编辑 `/etc/apt/sources.list` 文件，删除原文件所有内容，用以下内容取代：
deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib rpi
deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib rpi

# 编辑 `/etc/apt/sources.list.d/raspi.list` 文件，删除原文件所有内容，用以下内容取代：
deb http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui

# 执行下面命令更新软件
sudo apt update
sudo apt upgrade -y
sudo rm -f /etc/systemd/network/99-default.link

# 重启
sudo reboot
</code></pre>
<h2 id='安装-omv' ><a href='#anchor_安装-omv' id='anchor_安装-omv' class='anchor'>安装 OMV</a></h2>
<pre><code>wget -O - https://github.com/OpenMediaVault-Plugin-Developers/installScript/raw/master/install | sudo bash
</code></pre>
<p>如果连接失败，请设置下代理。</p>
<pre><code class="language-bash">sudo raspi-config
选择 【6 Advanced Options】
选择 【A5 Network Proxy Setting】
选择 【P1 All】
输入你的代理，我这里是【http://192.168.199.250:7777】
然后会自动重启。
</code></pre>
<p>完毕后再次执行上面的命令。</p>
<p>安装完毕后打开浏览器输入你树莓派的 ip 地址进入 web 管理页面</p>
<pre><code class="language-bash">账号：admin
密码：openmediavault
</code></pre>
<p>建议开启如下服务：</p>
<pre><code>FTP    这个什么都能连
NFS    这个Apple系和Linux连接较快
SMB/CIFS    这个主要给Windows连接
</code></pre>
<h3 id='共享文件夹-设置' ><a href='#anchor_共享文件夹-设置' id='anchor_共享文件夹-设置' class='anchor'>共享文件夹 设置</a></h3>
<p>如果无法选择，请在 OMV 中将硬盘里面先卸载，再挂载即可。</p>
<p>在<strong>共享文件夹</strong>中为每个目录的<strong>ACL</strong>增加 <strong>读/写/执行</strong>并<strong>应用到文件与子文件夹</strong>然后应用即可。</p>
<h3 id='服务设置' ><a href='#anchor_服务设置' id='anchor_服务设置' class='anchor'>服务设置</a></h3>
<p>FTP：开启匿名（内网用方便）</p>
<p>NFS：无法设置匿名。</p>
<p>SMB/CIFS：设置公开 <strong>允许访客</strong> （内网用方便）</p>
<h3 id='flashmemory' ><a href='#anchor_flashmemory' id='anchor_flashmemory' class='anchor'>flashmemory</a></h3>
<p>这个插件一定要装，要不 U 盘或者 tf 卡很容易就挂了。</p>
<h3 id='最后' ><a href='#anchor_最后' id='anchor_最后' class='anchor'>最后</a></h3>
<pre><code class="language-bash"># 删除代理
sudo raspi-config
选择 【6 Advanced Options】
选择 【A5 Network Proxy Setting】
选择 【P1 All】
设置为空【】
然后会自动重启。
</code></pre>
<h3 id='omv-中设置休眠' ><a href='#anchor_omv-中设置休眠' id='anchor_omv-中设置休眠' class='anchor'>OMV 中设置休眠</a></h3>
<pre><code class="language-bash">高级电源管理：1-待机状态时最低功耗(磁头停转)
自动声音管理：关闭
停转时间：10分钟
写入缓存：关闭(硬盘支持的话可以开启)
</code></pre>
<h2 id='性能' ><a href='#anchor_性能' id='anchor_性能' class='anchor'>性能</a></h2>
<p>电脑 -&gt; 树莓派 -&gt; USB3.0 移动硬盘 写入数据：约 30MB/s</p>
<p>USB3.0 移动硬盘 -&gt; 树莓派 -&gt; 电脑 读取数据：约 90MB/s</p>
</article>
          </article>
        </section>
      </div>
    </main>
    <script src="/lib/jquery-3.6.0/dist/jquery.min.js"></script>
    <script src="/lib/prismjs-1.23.0/prism.js"></script>
    <script src="/lib/bootstrap-4.6.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/lib/bootstrap-dropdown-hover-4.2.0/dist/bootstrap-dropdown-hover-change.js"></script>
    <script src="/lib/medium-zoom-1.0.6/dist/medium-zoom.min.js"></script>

    <script src="/lib/gitalk-1.7.2/dist/gitalk.min.js"></script>
    <script src="/lib/js/simple.js"></script>
  </body>
</html>
